# Day 32 - Send email (smtplib) & Manage Dates (datetime)

## Sending emails with python
- Email uses the SMTP protocol (Simple Mail Transfer Protocol) which is a protocol that takes email from a sender through different email servers to the desination recipient.
- Emails can be sent with python using the built in `smtplib` [library](https://docs.python.org/3/library/smtplib.html)

```python
import smtplib

# Email and password for email
my_email = "some_email@gmail.com"
password = "atotallysecurepassword"

# Email server and port
with smtplib.SMTP("smtp.gmail.com", port=587) as connection:

    # Securely connect to email server using TLS
    connection.starttls()
    
    #login
    connection.login(user=my_email, password=password)
    
    #Send mail from my_email to an address with the subject of "Hello"
    connection.sendmail(from_addr=my_email, to_addrs="anotheremail@gmail.com", msg="Subject:Hello\n\n"
                                                                              "This is the body of my email.")

```
## Datetime module

- The `datetime` [module](https://docs.python.org/3/library/datetime.html) is used for working with time in python
- You can get the current date and time using `datetime.datetime.now()` but this is saved as an object, so it's not as easy to work with
- Instead, you can save that object to a variable and then call different methods such as `.year` or `.hour`

```python
import datetime as dt

# Get current date and time in format: 2023-01-11 16:15:38.756731 as a datetime object
now = dt.datetime.now()

# Get current year from now object as an int
year = now.year

# Get current day
day = now.day

# Get current day of the week as a number (starting from 0 for Monday)
day_of_week = now.weekday()

```

- You can also store dates and times in datetime
```python
# Store date of birth. Returns with time of 0 since it's a default value: 1984-08-02 00:00:00
date_of_birth = dt.datetime(year=1984, month=8, day=2)

```

- Let's use what we learned to send a random quote from a quotes.txt file
```python
import smtplib
import datetime as dt
import random

my_email = "someemail@gmail.com"
password = "securepassword"
now = dt.datetime.now()
current_day = now.weekday()

if current_day == 2:
     
    # Open quotes list and read lines
    with open(file="quotes.txt", mode="r") as quote_file:
        quotes = quote_file.readlines()
        quote = random.choice(quotes)
     
    # Email server
        with smtplib.SMTP("smtp.gmail.com", port=587) as connection:
            # Securely connect using TLS
            connection.starttls()
    
            # Login
            connection.login(user=my_email, password=password)
    
            #Send mail from my_email to an address with the subject of "Hello"
            connection.sendmail(
                from_addr=my_email,
                to_addrs="recipientemail@gmail.com",
                msg=f"Subject:Here is a Random Quote for YOU!"
                    f"\n\n{quote}\n\n" 
                    f"This was generated by a Python Bot - BEEP BOOP BEEEP!"
            )

```

## Day 32 [Code Challenge](https://github.com/TroyCaywood/Python/blob/main/100%20Days%20of%20Code/CodeChallenges/Day-32/main.py) - Automated Birthday Wisher - Do not click before attempting yourself!
